<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Investa API Dashboard</title>
    <style>
        body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; background:#f9fafb; color:#111827; }
        header { background:#4f46e5; color:#fff; padding:16px 20px; }
        main { padding:20px; max-width: 1000px; margin: 0 auto; }
        .card { background:#fff; border-radius:12px; padding:16px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); margin-bottom:16px; }
        .row { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }
        input, select { border:1px solid #e5e7eb; border-radius:8px; padding:10px 12px; font-size:14px; }
        button { background:#4f46e5; color:#fff; border:none; border-radius:8px; padding:10px 14px; cursor:pointer; }
        button:disabled { opacity:.6; cursor:not-allowed; }
        pre { white-space: pre-wrap; word-break: break-word; background:#0b1020; color:#e5e7eb; padding:12px; border-radius:8px; overflow:auto; }
        a { color:#4f46e5; text-decoration: none; }
        .help { color:#6b7280; font-size: 12px; }
        .badge { background:#eef2ff; color:#3730a3; padding:2px 8px; border-radius:999px; font-size:12px; }
        .grid { display:grid; grid-template-columns: 1fr 1fr; gap:16px; }
        @media (max-width: 860px) { .grid { grid-template-columns: 1fr; } }
    </style>
    <script>
        async function registerUser(evt){
            evt.preventDefault();
            const form = evt.target;
            const email = form.email.value.trim();
            const password = form.password.value;
            const fullName = form.fullname.value.trim();
            const [first_name, ...last_parts] = fullName.split(/\s+/);
            const last_name = last_parts.join(' ');
            const payload = { username: email, email, password, confirm_password: password, first_name, last_name };
            const base = document.getElementById('baseUrl').value || 'http://127.0.0.1:8000/api';
            const res = await fetch(base + '/auth/register/', { method:'POST', headers: { 'Content-Type':'application/json' }, body: JSON.stringify(payload) });
            const data = await res.json().catch(()=>({}));
            document.getElementById('registerOutput').textContent = JSON.stringify({status: res.status, data}, null, 2);
        }

        async function loginUser(evt){
            evt.preventDefault();
            const form = evt.target;
            const username = form.username.value.trim();
            const password = form.password.value;
            const base = document.getElementById('baseUrl').value || 'http://127.0.0.1:8000/api';
            const res = await fetch(base + '/auth/login/', { method:'POST', headers: { 'Content-Type':'application/json' }, body: JSON.stringify({username, password}) });
            const data = await res.json().catch(()=>({}));
            document.getElementById('loginOutput').textContent = JSON.stringify({status: res.status, data}, null, 2);
        }
    </script>
    </head>
<body>
    <header>
        <h2>Investa API Dashboard <span class="badge">dev</span></h2>
    </header>
    <main>
        <div class="card">
            <div class="row">
                <label>Base URL</label>
                <input id="baseUrl" value="http://127.0.0.1:8000/api" style="min-width: 320px;" />
                <a href="/api/database/">View Database</a>
            </div>
            <p class="help">For Android emulator, use http://10.0.2.2:8000/api</p>
        </div>

        <div class="grid">
            <div class="card">
                <h3>Register</h3>
                <form onsubmit="registerUser(event)">
                    <div class="row"><input name="fullname" placeholder="Full Name" required /></div>
                    <div class="row"><input type="email" name="email" placeholder="Email" required /></div>
                    <div class="row"><input type="password" name="password" placeholder="Password" required /></div>
                    <div class="row"><button type="submit">Create Account</button></div>
                </form>
                <pre id="registerOutput"></pre>
            </div>

            <div class="card">
                <h3>Login</h3>
                <form onsubmit="loginUser(event)">
                    <div class="row"><input name="username" placeholder="Username (email)" required /></div>
                    <div class="row"><input type="password" name="password" placeholder="Password" required /></div>
                    <div class="row"><button type="submit">Login</button></div>
                </form>
                <pre id="loginOutput"></pre>
            </div>
        </div>

        <div class="card">
            <h3>Helpful Endpoints</h3>
            <ul>
                <li><a href="/api/languages/">GET /api/languages/</a></li>
                <li><a href="/api/courses/">GET /api/courses/</a> (auth required)</li>
                <li><a href="/api/profiles/my_profile/">GET /api/profiles/my_profile/</a> (auth required)</li>
            </ul>
        </div>
    </main>
</body>
</html>


