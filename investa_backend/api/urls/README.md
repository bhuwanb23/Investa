# URLs Directory

This directory contains all Django URL configurations organized by functionality. The URLs are separated into console views (HTML pages) and API endpoints (REST API) for better organization and maintainability.

## üìÅ Directory Structure

```
urls/
‚îú‚îÄ‚îÄ __init__.py           # Package initialization
‚îú‚îÄ‚îÄ console.py            # Console HTML views (dashboard, database, index)
‚îú‚îÄ‚îÄ api.py                # REST API endpoints
‚îî‚îÄ‚îÄ README.md            # This file
```

## üéØ URL Files

### `console.py` - Console Views
**Purpose**: Handle HTML-based console views for development and administration

**URL Patterns**:
- **`index`**: Landing page
  - **URL**: `/`
  - **View**: `views.index`
  - **Template**: `index.html`
  - **Purpose**: Console landing page with navigation and overview

- **`dashboard`**: Development dashboard
  - **URL**: `/dashboard/`
  - **View**: `views.dashboard`
  - **Template**: `dashboard.html`
  - **Purpose**: Interactive API testing and development interface

- **`database`**: Database explorer
  - **URL**: `/database/`
  - **View**: `views.database_view`
  - **Template**: `database.html`
  - **Purpose**: Database table exploration and visualization

**Features**:
- **Template Inheritance**: All views extend `base.html` for consistent navigation
- **Development Tools**: Interactive interfaces for API testing and database exploration
- **Responsive Design**: Mobile-friendly layouts
- **Real-time Updates**: Dynamic content updates and form handling

### `api.py` - REST API Endpoints
**Purpose**: Handle all REST API endpoints organized by functionality

**URL Patterns**:

#### Authentication Endpoints
- **`api_token_auth`**: Custom login endpoint
  - **URL**: `/api/auth/login/`
  - **View**: `views.CustomAuthToken`
  - **Method**: POST
  - **Purpose**: Enhanced login with profile data

- **`user_registration`**: User registration
  - **URL**: `/api/auth/register/`
  - **View**: `views.UserRegistrationView`
  - **Method**: POST
  - **Purpose**: User registration with profile setup

- **`api_token`**: Standard token authentication
  - **URL**: `/api/auth/token/`
  - **View**: `obtain_auth_token`
  - **Method**: POST
  - **Purpose**: Standard Django REST Framework token auth

- **`auth_me`**: Get current user data
  - **URL**: `/api/auth/me/`
  - **View**: `views.MeView`
  - **Method**: GET
  - **Purpose**: Get complete user profile and settings

- **`auth_logout`**: User logout
  - **URL**: `/api/auth/logout/`
  - **View**: `views.LogoutView`
  - **Method**: POST
  - **Purpose**: Invalidate user tokens

#### Model Endpoints (via DefaultRouter)
The following endpoints are automatically generated by Django REST Framework's `DefaultRouter`:

**User & Profile**:
- **`languages`**: Language management
  - **URL**: `/api/languages/`
  - **ViewSet**: `views.LanguageViewSet`
  - **Methods**: GET (list, retrieve)
  - **Purpose**: List and retrieve supported languages

- **`profiles`**: User profile management
  - **URL**: `/api/profiles/`
  - **ViewSet**: `views.UserProfileViewSet`
  - **Methods**: GET, POST, PUT, PATCH, DELETE
  - **Purpose**: User profile CRUD operations

**Security**:
- **`security-settings`**: Security settings management
  - **URL**: `/api/security-settings/`
  - **ViewSet**: `views.SecuritySettingsViewSet`
  - **Methods**: GET, POST, PUT, PATCH, DELETE
  - **Purpose**: Security settings CRUD operations

- **`sessions`**: Session management
  - **URL**: `/api/sessions/`
  - **ViewSet**: `views.UserSessionViewSet`
  - **Methods**: GET (list, retrieve)
  - **Purpose**: Active session monitoring

**Privacy**:
- **`privacy-settings`**: Privacy settings management
  - **URL**: `/api/privacy-settings/`
  - **ViewSet**: `views.PrivacySettingsViewSet`
  - **Methods**: GET, POST, PUT, PATCH, DELETE
  - **Purpose**: Privacy settings CRUD operations

**Learning**:
- **`learning-progress`**: Learning progress management
  - **URL**: `/api/learning-progress/`
  - **ViewSet**: `views.LearningProgressViewSet`
  - **Methods**: GET (list, retrieve)
  - **Purpose**: Learning progress tracking

- **`badges`**: Badge management
  - **URL**: `/api/badges/`
  - **ViewSet**: `views.BadgeViewSet`
  - **Methods**: GET (list, retrieve)
  - **Purpose**: Badge listing and details

**Trading**:
- **`trading-performance`**: Trading performance management
  - **URL**: `/api/trading-performance/`
  - **ViewSet**: `views.TradingPerformanceViewSet`
  - **Methods**: GET (list, retrieve)
  - **Purpose**: Trading performance tracking

**Notifications**:
- **`notifications`**: Notification management
  - **URL**: `/api/notifications/`
  - **ViewSet**: `views.NotificationViewSet`
  - **Methods**: GET (list, retrieve)
  - **Purpose**: Notification management

## üîó URL Relationships

### Console Flow
1. **Landing Page**: `/` ‚Üí `index.html` (overview and navigation)
2. **Dashboard**: `/dashboard/` ‚Üí `dashboard.html` (API testing interface)
3. **Database**: `/database/` ‚Üí `database.html` (database exploration)

### API Flow
1. **Authentication**: `/api/auth/*` ‚Üí Token-based authentication
2. **User Data**: `/api/profiles/*` ‚Üí User profile management
3. **Settings**: `/api/security-settings/*`, `/api/privacy-settings/*` ‚Üí User settings
4. **Progress**: `/api/learning-progress/*`, `/api/trading-performance/*` ‚Üí User progress
5. **System**: `/api/notifications/*`, `/api/sessions/*` ‚Üí System management

## üõ†Ô∏è URL Configuration

### Main Project URLs (`investa_backend/urls.py`)
```python
urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('api.urls.console')),  # Console views at root
    path('api/', include('api.urls.api')),   # API endpoints under /api/
]
```

### Console URLs (`api/urls/console.py`)
```python
urlpatterns = [
    path('', views.index, name='index'),
    path('dashboard/', views.dashboard, name='dashboard'),
    path('database/', views.database_view, name='database'),
]
```

### API URLs (`api/urls/api.py`)
```python
# Router registration
router = DefaultRouter()
router.register(r'languages', views.LanguageViewSet)
router.register(r'profiles', views.UserProfileViewSet, basename='profile')
# ... other ViewSets

# URL patterns
urlpatterns = [
    path('', include(router.urls)),
    path('auth/login/', views.CustomAuthToken.as_view(), name='api_token_auth'),
    path('auth/register/', views.UserRegistrationView.as_view({'post': 'create'}), name='user_registration'),
    # ... other auth endpoints
]
```

## üìä Complete URL Reference

### Console URLs
| URL | View | Template | Purpose |
|-----|------|----------|---------|
| `/` | `index` | `index.html` | Landing page |
| `/dashboard/` | `dashboard` | `dashboard.html` | Development dashboard |
| `/database/` | `database_view` | `database.html` | Database explorer |

### API URLs
| URL | Method | View/ViewSet | Purpose |
|-----|--------|--------------|---------|
| `/api/auth/login/` | POST | `CustomAuthToken` | User login |
| `/api/auth/register/` | POST | `UserRegistrationView` | User registration |
| `/api/auth/token/` | POST | `obtain_auth_token` | Standard token auth |
| `/api/auth/me/` | GET | `MeView` | Get current user |
| `/api/auth/logout/` | POST | `LogoutView` | User logout |
| `/api/languages/` | GET | `LanguageViewSet` | List languages |
| `/api/languages/{id}/` | GET | `LanguageViewSet` | Get language |
| `/api/profiles/` | GET, POST | `UserProfileViewSet` | Profile CRUD |
| `/api/profiles/{id}/` | GET, PUT, PATCH, DELETE | `UserProfileViewSet` | Profile operations |
| `/api/profiles/my_profile/` | GET | `UserProfileViewSet` | Get my profile |
| `/api/profiles/update_profile/` | PUT | `UserProfileViewSet` | Update my profile |
| `/api/security-settings/` | GET, POST | `SecuritySettingsViewSet` | Security CRUD |
| `/api/security-settings/{id}/` | GET, PUT, PATCH, DELETE | `SecuritySettingsViewSet` | Security operations |
| `/api/security-settings/my_settings/` | GET | `SecuritySettingsViewSet` | Get my settings |
| `/api/security-settings/update_settings/` | PUT | `SecuritySettingsViewSet` | Update my settings |
| `/api/security-settings/toggle_2fa/` | POST | `SecuritySettingsViewSet` | Toggle 2FA |
| `/api/sessions/` | GET | `UserSessionViewSet` | List sessions |
| `/api/sessions/{id}/` | GET | `UserSessionViewSet` | Get session |
| `/api/sessions/logout_all_devices/` | POST | `UserSessionViewSet` | Logout all devices |
| `/api/privacy-settings/` | GET, POST | `PrivacySettingsViewSet` | Privacy CRUD |
| `/api/privacy-settings/{id}/` | GET, PUT, PATCH, DELETE | `PrivacySettingsViewSet` | Privacy operations |
| `/api/privacy-settings/my_settings/` | GET | `PrivacySettingsViewSet` | Get my settings |
| `/api/privacy-settings/update_settings/` | PUT | `PrivacySettingsViewSet` | Update my settings |
| `/api/learning-progress/` | GET | `LearningProgressViewSet` | List progress |
| `/api/learning-progress/{id}/` | GET | `LearningProgressViewSet` | Get progress |
| `/api/learning-progress/my_progress/` | GET | `LearningProgressViewSet` | Get my progress |
| `/api/badges/` | GET | `BadgeViewSet` | List badges |
| `/api/badges/{id}/` | GET | `BadgeViewSet` | Get badge |
| `/api/badges/my_badges/` | GET | `BadgeViewSet` | Get my badges |
| `/api/trading-performance/` | GET | `TradingPerformanceViewSet` | List performance |
| `/api/trading-performance/{id}/` | GET | `TradingPerformanceViewSet` | Get performance |
| `/api/trading-performance/my_performance/` | GET | `TradingPerformanceViewSet` | Get my performance |
| `/api/notifications/` | GET | `NotificationViewSet` | List notifications |
| `/api/notifications/{id}/` | GET | `NotificationViewSet` | Get notification |
| `/api/notifications/my_notifications/` | GET | `NotificationViewSet` | Get my notifications |
| `/api/notifications/mark_all_read/` | POST | `NotificationViewSet` | Mark all read |
| `/api/notifications/{id}/mark_read/` | POST | `NotificationViewSet` | Mark as read |
| `/api/notifications/unread_count/` | GET | `NotificationViewSet` | Get unread count |

## üîí Security Considerations

### Authentication
- **Protected Endpoints**: All API endpoints (except languages) require authentication
- **Token-based Auth**: Uses Django REST Framework token authentication
- **Session Management**: Active session tracking and management

### Authorization
- **User Isolation**: Users can only access their own data
- **Permission Classes**: Appropriate permissions for each endpoint
- **Custom Actions**: User-specific actions for profile and settings

### URL Security
- **HTTPS Ready**: URLs are configured to work with HTTPS
- **CSRF Protection**: Console views include CSRF protection
- **Input Validation**: All endpoints include proper input validation

## üöÄ Best Practices

### URL Design
1. **RESTful Design**: Follow REST principles for API URLs
2. **Consistent Naming**: Use consistent naming conventions
3. **Logical Grouping**: Group related endpoints together
4. **Versioning Ready**: Structure supports future API versioning

### Organization
1. **Separation of Concerns**: Console and API URLs are separate
2. **Modular Structure**: Each file handles specific functionality
3. **Easy Maintenance**: Clear structure for easy updates
4. **Scalable Design**: Easy to add new endpoints and views

### Documentation
1. **Clear Naming**: Descriptive URL names and patterns
2. **Consistent Patterns**: Similar operations follow consistent patterns
3. **Proper Comments**: Clear documentation for complex patterns
4. **API Documentation**: URLs support automatic API documentation

## üîß Development Workflow

### Adding New Console Views
1. Create view function in `views/console.py`
2. Add URL pattern in `urls/console.py`
3. Create template in `templates/`
4. Update navigation in `base.html` if needed

### Adding New API Endpoints
1. Create ViewSet in appropriate `views/*.py` file
2. Register ViewSet in `urls/api.py` router
3. Add custom actions if needed
4. Update API documentation

### URL Testing
1. **Console URLs**: Test in browser at `http://127.0.0.1:8000/`
2. **API URLs**: Test with tools like Postman or curl
3. **Authentication**: Test protected endpoints with valid tokens
4. **Permissions**: Verify user isolation and access control

## üìù Notes

- **Router URLs**: ViewSet URLs are automatically generated by `DefaultRouter`
- **Custom Actions**: ViewSets can have custom actions beyond standard CRUD
- **Template Inheritance**: All console views extend `base.html`
- **API Versioning**: Structure supports future API versioning (e.g., `/api/v1/`)
- **Development Tools**: Console views provide development and debugging tools
